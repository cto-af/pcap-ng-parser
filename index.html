<!DOCTYPE html><html class="default" lang="en" data-base="./"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@cto.af/pcap-ng-parser</title><meta name="description" content="Documentation for @cto.af/pcap-ng-parser"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="index.html" class="title">@cto.af/pcap-ng-parser</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>@cto.af/pcap-ng-parser</h1></div><div class="tsd-panel tsd-typography"><h1 id="overview" class="tsd-anchor-link">Overview<a href="#overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>@cto.af/pcap-ng-parser is a stream-based module to decode, print and analyze network traffic packets. With this module, you can read from an existing .pcapng file or connect it to an active stream.</p>
<h1 id="installation" class="tsd-anchor-link">Installation<a href="#installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This module is available through the <a href="https://www.npmjs.com/">npm registry</a>.</p>
<pre><code class="bash"><span class="hl-0">$</span><span class="hl-1"> </span><span class="hl-2">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@cto.af/pcap-ng-parser</span>
</code><button type="button">Copy</button></pre>

<h1 id="usage" class="tsd-anchor-link">Usage<a href="#usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><h2 id="via-pcapng-file" class="tsd-anchor-link">Via .pcapng File<a href="#via-pcapng-file" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Here is a quick example of how to log out packets to the console from a valid .pcapng file named <code>myfile.pcapng</code>.</p>
<pre><code class="javascript"><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">PCAPNGParser</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@cto.af/pcap-ng-parser&#39;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">fs</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;node:fs&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">pcapNgParser</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">PCAPNGParser</span><span class="hl-1">();</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">myFileStream</span><span class="hl-1"> = </span><span class="hl-4">fs</span><span class="hl-1">.</span><span class="hl-0">createReadStream</span><span class="hl-1">(</span><span class="hl-2">&#39;./myfile.pcapng&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-4">myFileStream</span><span class="hl-1">.</span><span class="hl-0">pipe</span><span class="hl-1">(</span><span class="hl-4">pcapNgParser</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&#39;data&#39;</span><span class="hl-1">, </span><span class="hl-4">parsedPacket</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">parsedPacket</span><span class="hl-1">);</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  .</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&#39;interface&#39;</span><span class="hl-1">, </span><span class="hl-4">interfaceInfo</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">interfaceInfo</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span>
</code><button type="button">Copy</button></pre>

<p>In the example above, we create a new Readable stream from our file and pipe the instance <code>pcapNgParser</code> which will read our packet data on the <code>_transform</code> event.</p>
<h2 id="via-tcpdump" class="tsd-anchor-link">Via TCPDump<a href="#via-tcpdump" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>You can also pipe from TCPDump using <code>process.stdin</code> for a command line interaction.</p>
<pre><code class="javascript"><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">PCAPNGParser</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@cto.af/pcap-ng-parser&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">pcapNgParser</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">PCAPNGParser</span><span class="hl-1">();</span><br/><br/><span class="hl-4">process</span><span class="hl-1">.</span><span class="hl-4">stdin</span><span class="hl-1">.</span><span class="hl-0">pipe</span><span class="hl-1">(</span><span class="hl-4">pcapNgParser</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&#39;data&#39;</span><span class="hl-1">, </span><span class="hl-4">parsedPacket</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">parsedPacket</span><span class="hl-1">);</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  .</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&#39;interface&#39;</span><span class="hl-1">, </span><span class="hl-4">interfaceInfo</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">interfaceInfo</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span>
</code><button type="button">Copy</button></pre>

<pre><code class="bash"><span class="hl-0">$</span><span class="hl-1"> </span><span class="hl-2">sudo</span><span class="hl-1"> </span><span class="hl-2">tcpdump</span><span class="hl-1"> </span><span class="hl-5">-w</span><span class="hl-1"> </span><span class="hl-2">-</span><span class="hl-1"> | </span><span class="hl-0">node</span><span class="hl-1"> </span><span class="hl-2">exampleAbove.js</span>
</code><button type="button">Copy</button></pre>

<p>Note that in order to utilize tcpdump you must be a superuser. Refer to <a href="http://www.tcpdump.org/manpages/tcpdump.1.html">tcpdump documentation</a> for details.</p>
<p>Further note: If you specify an interface to listen on with &quot;-i&quot;, tcpdump no
longer uses the pcapng format.</p>
<h2 id="other-examples" class="tsd-anchor-link">Other Examples<a href="#other-examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Additional examples can be found in the <a href="/examples/">examples directory</a>.</p>
<h1 id="class-pcapngparser" class="tsd-anchor-link">Class PCAPNGParser<a href="#class-pcapngparser" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>PCAPNGParser is an extension of the <a href="https://nodejs.org/api/stream.html#stream_class_stream_transform">stream.Transform
class</a>. The
PCAPNGParser class fires the following events:</p>
<ul>
<li><code>data</code>: An Enhanced Packet or Simple block was parsed.</li>
<li><code>section</code>: A Section Header block was parsed.</li>
<li><code>interface</code>: An Interface block was parsed.</li>
<li><code>names</code>: A Name Resolution block was parsed.</li>
<li><code>secrets</code>: A Decryption Secrets block was parsed.</li>
<li><code>stats</code>: An Interface Statistics block was parsed.</li>
<li><code>custom</code>: A Custom block was parsed.</li>
<li><code>blockType</code>: An unknown block type has been received.</li>
</ul>
<p>See the full <a href="https://cto-af.github.io/pcap-ng-parser/">API documentation</a> for
the types of the event parameters.</p>
<h1 id="contribution" class="tsd-anchor-link">Contribution<a href="#contribution" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>Refer to the the <a href="/docs/CONTRIBUTING.md">Contribution Guide</a> for details on how to contribute.</p>
<h1 id="license" class="tsd-anchor-link">License<a href="#license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This module is covered under the BSD-3 Open Software License. Review the <a href="/docs/LICENSE.md">License Documention</a> for more information.</p>
<h1 id="provenance" class="tsd-anchor-link">Provenance<a href="#provenance" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This code was forked from <a href="https://github.com/CollinearGroup/pcap-ng-parser">https://github.com/CollinearGroup/pcap-ng-parser</a> due
to lack of maintenance.  To simplify matters, copyright remains with the
original authors, including all changes made in this repository.  If the
original authors contact me (easiest would be to file an issue here), all of
this can be changed in any way that suits them.</p>
<p>The following things have been added:</p>
<ul>
<li>Fixed critical RangeError bug</li>
<li>Made 'end' and 'finish' events fire correctly by removing broken _finish code.  Note that you have to add an event for 'data' to get these events or 'close'
to fire, as with all Node Transform streams.</li>
<li>Converted to ES6 (BREAKING)</li>
<li>Added TypeScript types</li>
<li>Brought dependencies up to date</li>
<li>Added linting in @cto.af house style (to make maintenance easier)</li>
<li>Added test coverage</li>
<li>Renamed 'master' branch to 'main'</li>
<li>Added Github Actions for testing and publishing</li>
<li>Fixed broken links in readme and code</li>
<li>Fixed issues with padding for options</li>
<li>Now reads all options for supported block types, giving them names when known</li>
<li>Fixed issues with reading unexpected sizes in input stream</li>
<li>Added support for AbortSignals</li>
<li>Added support for multiple Section Header blocks in a stream, including
changes of endian-ness.</li>
<li>Added support for Simple Packet blocks.</li>
<li>Added support for Name Resolution blocks.</li>
<li>Added support for Interface Statistics blocks.</li>
<li>Added initial Support for Decryption Secrets blocks.</li>
<li>Added support for Custom blocks.</li>
<li>Added Enhanced Packet flag decoding.</li>
<li>Added converting timestamps to JS Dates.  Does not handle timezones yet. (BREAKING)</li>
<li>Added generate API documentation.</li>
</ul>
<p><a href="https://github.com/cto-af/pcap-ng-parser/actions/workflows/node.js.yml"><img src="https://github.com/cto-af/pcap-ng-parser/actions/workflows/node.js.yml/badge.svg" alt="Tests"></a>
<a href="https://codecov.io/gh/cto-af/pcap-ng-parser"><img src="https://codecov.io/gh/cto-af/pcap-ng-parser/graph/badge.svg?token=Akjw67WYcn" alt="codecov"></a></p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#overview"><span>Overview</span></a><a href="#installation"><span>Installation</span></a><a href="#usage"><span>Usage</span></a><ul><li><a href="#via-pcapng-file"><span>Via .pcapng <wbr/>File</span></a></li><li><a href="#via-tcpdump"><span>Via <wbr/>TCP<wbr/>Dump</span></a></li><li><a href="#other-examples"><span>Other <wbr/>Examples</span></a></li></ul><a href="#class-pcapngparser"><span>Class <wbr/>PCAPNG<wbr/>Parser</span></a><a href="#contribution"><span>Contribution</span></a><a href="#license"><span>License</span></a><a href="#provenance"><span>Provenance</span></a></div></details></div><div class="site-menu"><nav id="tsd-sidebar-links" class="tsd-navigation"><a href="https://github.com/cto-af/pcap-ng-parser/">GitHub</a><a href="https://www.ietf.org/archive/id/draft-ietf-opsawg-pcapng-04.html">Spec</a><a href="http://cto-af.github.io/pcap-ng-parser/">Documentation</a></nav><nav class="tsd-navigation"><a href="modules.html">@cto.af/pcap-ng-parser</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
